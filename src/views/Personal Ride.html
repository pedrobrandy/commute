<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Personal Ride</title>
    <style>
      body {
        font-family: UberMove, UberMoveText, system-ui, "Helvetica Neue", Helvetica, Arial, sans-serif;
        margin: 0;
        background-color: white;
        display: flex;
        flex-direction: column;
        align-items: center;
        min-height: 100vh;
        overflow-x: hidden;
      }

      /* Main layout container */
      .main-layout {
        display: grid;
        grid-template-columns: 1fr 2fr;
        width: 95%;
        min-height: 100vh;
        position: relative;
      }

      /* Benefits section (1 column) - LEFT SIDE */
      .benefits-section {
        background: white;
        padding: 40px 30px;
        order: 1;
        display: flex;
        flex-direction: column;
        justify-content: center;
        margin-right: -33px;
      }

      /* Benefits styling */
      .benefits-container {
        max-width: 600px; /* Increased from 350px for desktop */
      }

      .benefits-title {
        font-size: 24px;
        font-weight: 600;
        color: #1B263B;
        margin-bottom: 30px;
        text-align: center;
      }

      .benefits-list {
        list-style: none;
        padding: 0;
        margin: 0;
        display: flex;
        flex-direction: column;
        gap: 25px;
      }

      .benefit-item {
        display: flex;
        align-items: flex-start;
        gap: 12px;
        padding: 0;
      }

      .benefit-icon {
        width: 87px; /* Smaller for mobile but still large */
        height: 65px; /* Smaller for mobile but still large */
        flex-shrink: 0;
        margin-top: 0;
      }

      .benefit-content {
        flex: 1;
      }

      .benefit-text {
        font-size: 16px;
        line-height: 1.5;
        color: #415A77;
        margin: 0;
      }

      .terms-link {
        display: inline-block;
        margin-top: 30px;
        color: #0078D4;
        text-decoration: none;
        font-weight: 500;
        font-size: 14px;
        text-align: center;
        width: 100%;
      }

      .terms-link:hover {
        text-decoration: underline;
      }

      /* Background image section (2 columns) - RIGHT SIDE */
      .background-section {
        background-image: url('https://pedrobrandy.github.io/commute/image/PersonalRideImage.png');
        background-size: cover;
        background-position: center;
        background-repeat: no-repeat;
        position: relative;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-left: -31px;
        order: 2;
      }

      /* Mobile background image */
      @media (max-width: 768px) {
        .background-section {
          background-image: url('image/MyPersonalRideMobile.png');
          background-size: cover;
          background-position: center;
        }
      }

      /* Form overlay on background image - LEFT SIDE (matching Shared Ride) */
      .form-overlay {
        background: transparent;
        backdrop-filter: none;
        border-radius: 0;
        padding: 20px;
        box-shadow: none;
        max-width: 200px;
        width: 80%;
        margin: 0;
        position: absolute;
        bottom: 73px;
        left: 30px;
        z-index: 10;
      }

      /* Adjust form elements for smaller size */
      .form-fields {
        display: flex;
        flex-direction: column;
        gap: 8px;
      }

      .input-group {
        display: flex;
        flex-direction: column;
        gap: 2px;
      }

      .input-group label {
        font-weight: 600;
        color: #1B263B;
        font-size: 12px;
      }

      .input-with-icon {
        position: relative;
        display: flex;
        align-items: center;
      }

      .input-icon {
        position: absolute;
        width: 18px;
        height: 18px;
        left: 10px;
        z-index: 2;
        filter: brightness(0) saturate(100%) invert(15%) sepia(15%) saturate(1034%) hue-rotate(202deg) brightness(95%) contrast(96%);
      }

      .input-group input,
      .input-group select {
        padding: 12px 12px 12px 35px;
        font-size: 16px;
        border-radius: 8px;
        border: 2px solid #E0E1DD;
        min-height: 44px;
        color: #666;
      }

      .input-group input::placeholder {
        color: #666;
        font-size: 16px;
      }

      .input-group input:focus,
      .input-group select:focus {
        outline: none;
        border-color: #778DA9;
      }

      .input-group input:invalid,
      .input-group select:invalid {
        outline: #778DA9;
        border-color: #E0E1DD;
      }

      button[type="submit"] {
        background-color: #0D1B2A;
        color: white;
        border: none;
        padding: 10px 20px;
        border-radius: 6px;
        font-size: 12px;
        font-weight: 600;
        cursor: pointer;
        transition: background-color 0.3s ease;
      }

      button[type="submit"]:hover {
        background-color: #E0E1DD;
        color: black;
      }

      button[type="submit"]:disabled {
        background-color: #E0E1DD;
        cursor: not-allowed;
      }

      /* Responsive design */
      @media (max-width: 1024px) {
        .main-layout {
          grid-template-columns: 1fr;
          grid-template-rows: auto auto;
        }
        
        .background-section {
          min-height: 400px;
          position: relative;
          order: 2;
        }
        
        .form-overlay {
          position: absolute;
          bottom: 25px;
          left: 50%;
          transform: translateX(-50%);
          max-width: 220px;
        }
        
        .benefits-section {
          padding: 30px 20px;
          order: 3;
        }
        
        .benefits-container {
          max-width: 100%;
        }
      }

      @media (max-width: 768px) {
        body {
          min-height: 100vh;
          height: 100vh;
          overflow: hidden;
          padding: 0;
          margin: 0;
        }
        
        .main-layout {
          display: flex;
          flex-direction: column;
          gap: 0;
          height: 100vh;
          min-height: 100vh;
          width: 100%;
          overflow: hidden;
          grid-template-columns: 1fr;
          grid-template-rows: auto auto;
        }
        
        .ride-selector-buttons {
          position: static;
          justify-content: center;
          margin: 20px 0;
          gap: 15px;
        }
        
        .background-section {
          min-height: 411px;
          order: 2;
          border-radius: 25px;
          margin-left: 0;
        }
        
        .form-overlay {
          max-width: 280px;
          padding: 20px;
          bottom: 10px;
          left: 50%;
          transform: translateX(-50%);
        }
        
        .benefits-section {
          padding: 20px 15px;
          order: 3;
          flex: 1;
          display: flex;
          align-items: flex-start; /* Changed from center */
          background: white;
          margin-right: 0;
        }
        
        .benefits-container {
          max-width: 100%;
          width: 100%;
        }
        
        .form-fields {
          gap: 15px;
        }
        
        .input-group {
          gap: 6px;
        }
        
        .input-group label {
          font-size: 13px;
          font-weight: 600;
        }
        
        .input-group input,
        .input-group select {
          padding: 12px 12px 12px 35px;
          font-size: 16px;
          border-radius: 8px;
          border: 2px solid #E0E1DD;
          min-height: 44px;
          color: #666;
        }
        
        /* Specific styles for the location row on mobile */
        .input-group.location-row {
          display: flex !important;
          flex-direction: row !important;
          gap: 8px !important;
          align-items: stretch !important;
        }
        
        .input-group.location-row .input-with-icon {
          flex: 1 !important;
          min-width: 0 !important;
        }
        
        .input-group.location-row .input-with-icon input {
          width: 100% !important;
          min-width: 0 !important;
          box-sizing: border-box !important;
        }
        
        .input-icon {
          width: 18px;
          height: 18px;
          left: 10px;
        }
        
        .benefits-title {
          font-size: 20px;
          margin-bottom: 20px;
        }
        
        .benefits-list {
          gap: 15px;
        }
        
        .benefit-item {
          gap: 12px;
          align-items: flex-start; /* Better for large icons */
        }
        
        .benefit-icon {
          width: 87px; /* Smaller for mobile but still large */
          height: 75px; /* Smaller for mobile but still large */
          margin-top: 0;
        }
        
        .benefit-text {
          font-size: 14px;
          line-height: 1.4;
        }
      }

      /* iPhone specific optimizations */
      @media (max-width: 480px) {
        body {
          min-height: 100vh;
          height: 100vh;
          overflow: hidden;
          padding: 0;
          margin: 0;
        }
        
        .main-layout {
          display: flex;
          flex-direction: column;
          gap: 0;
          height: 100vh;
          min-height: 100vh;
          width: 100%;
          overflow: hidden;
          grid-template-columns: 1fr;
          grid-template-rows: auto auto;
        }

        .benefits-section {
          padding: 15px 10px; /* Even smaller padding */
          flex: 1;
          display: flex;
          align-items: flex-start; /* Changed from center */
          background: white;
          margin-right: 0;
        }
        
        .benefits-container {
          max-width: 100%;
          width: 100%;
        }
        
        .benefits-title {
          font-size: 18px; /* Smaller title */
          margin-bottom: 15px; /* Less margin */
        }
        
        .benefits-list {
          gap: 12px; /* Tighter spacing */
        }
        
        .benefit-item {
          gap: 10px; /* Tighter gap */
          align-items: flex-start; /* Better for longer text */
        }
        
        .benefit-icon {
        width: 87px;
        height: 75px; /* Smaller for mobile but still large */
          margin-top: -8px;
        }
        
        .benefit-text {
          font-size: 13px; /* Smaller text */
          line-height: 1.3; /* Tighter line height */
        }

        .form-overlay {
          max-width: 320px;
          padding: 15px;
          bottom: 15px;
        }
        
        .input-group input,
        .input-group select {
          padding: 12px 12px 12px 35px;
          font-size: 16px;
          min-height: 44px;
        }
        
        .input-icon {
          width: 20px;
          height: 20px;
          left: 12px;
        }
        
        .input-group label {
          font-size: 14px;
        }
        
        button[type="submit"] {
          padding: 16px 28px;
          font-size: 18px;
          min-height: 50px;
        }
        
        .form-fields {
          gap: 18px;
        }
        
        .input-group {
          gap: 8px;
        }
      }

      form {
        padding: 0px 30px;
        border-radius: 12px;
        width: 100%;
        max-width: 100%;
        margin: 0 auto;
        display: flex;
        flex-direction: column;
      }

      h2 {
        text-align: center;
        margin-bottom: 1.5rem;
        color: #333;
        font-size: clamp(1.2rem, 2vw, 1.6rem);
      }

      .form-fields {
        gap: 0px;
      }

      .input-group {
        margin-bottom: 15px;
      }

      .input-with-icon {
        position: relative;
        display: flex;
        align-items: center;
      }

      .input-icon {
        position: absolute;
        width: 18px;
        height: 18px;
        left: 10px;
        z-index: 2;
        filter: brightness(0) saturate(100%) invert(15%) sepia(15%) saturate(1034%) hue-rotate(202deg) brightness(95%) contrast(96%);
      }

      label {
        margin-bottom: 6px;
        font-weight: bold;
        color: #444;
        font-size: 0.95rem;
      }

      input[type="text"],
      input[type="tel"],
      input[type="date"],
      input[type="time"],
      select {
        width: 100%;
        padding: 8px 8px 8px 30px;
        border-radius: 6px;
        border: 2px solid #E0E1DD;
        box-sizing: border-box;
        transition: border-color 0.3s ease;
      }

      /* iPhone compatibility for time inputs */
      input[type="time"] {
        -webkit-appearance: none;
        -moz-appearance: none;
        appearance: none;
        background: white;
        border: 2px solid #E0E1DD;
        border-radius: 6px;
        padding: 8px 8px 8px 30px;
        font-size: 16px; /* Prevents zoom on iPhone */
        font-family: UberMove, UberMoveText, system-ui, "Helvetica Neue", Helvetica, Arial, sans-serif;
        color: #1B263B;
        width: 100%;
        box-sizing: border-box;
        transition: all 0.3s ease;
      }

      input[type="time"]:focus {
        outline: none;
        border-color: #007bff;
        box-shadow: 0 0 0 2px rgba(0, 123, 255, 0.15);
      }

      /* iPhone Safari specific styles */
      @supports (-webkit-touch-callout: none) {
        input[type="time"] {
          -webkit-appearance: none;
          background: white;
          border: 2px solid #E0E1DD;
          border-radius: 6px;
          padding: 8px 8px 8px 30px;
          font-size: 16px;
          min-height: 44px; /* Minimum touch target size for iOS */
        }
        
        input[type="time"]::-webkit-datetime-edit {
          padding: 0;
          color: #1B263B;
        }
        
        input[type="time"]::-webkit-datetime-edit-fields-wrapper {
          padding: 0;
        }
        
        input[type="time"]::-webkit-datetime-edit-text {
          padding: 0 2px;
          color: #666;
        }
        
        input[type="time"]::-webkit-datetime-edit-hour-field,
        input[type="time"]::-webkit-datetime-edit-minute-field {
          padding: 0 2px;
          color: #1B263B;
        }
        
        input[type="time"]::-webkit-calendar-picker-indicator {
          background: transparent;
          color: transparent;
          cursor: pointer;
          height: 20px;
          width: 20px;
          margin-left: 5px;
        }
      }

      /* Fallback for older browsers */
      input[type="time"]::-webkit-inner-spin-button,
      input[type="time"]::-webkit-outer-spin-button {
        -webkit-appearance: none;
        margin: 0;
      }

      input[type="time"]::-webkit-calendar-picker-indicator {
        background: transparent;
        color: transparent;
        cursor: pointer;
        height: 20px;
        width: 20px;
        margin-left: 5px;
      }

      input:focus,
      select:focus {
        border-color: #007bff;
        outline: none;
        box-shadow: 0 0 0 2px rgba(0, 123, 255, 0.15);
      }

      button[type="submit"] {
        background-color: #0D1B2A;
        color: white;
        border: none;
        padding: 10px 20px;
        border-radius: 6px;
        font-size: 12px;
        font-weight: 600;
        cursor: pointer;
        transition: background-color 0.3s ease;
      }
      button[type="submit"]:hover {
        background-color: #E0E1DD;
        color: black;
      }


      #summary,
      #sorryMessage {
        display: none;
        margin: 20px auto;
        background: white;
        padding: 20px;
        border-radius: 12px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        font-size: 1rem;
        line-height: 1.4;
        width: 80%;
        max-width: 600px;
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        z-index: 10000;
      }

      #summaryContent {
        margin-bottom: 20px;
      }

      #map {
        width: 100%;
        height: 300px;
        margin-top: 20px;
        border: 1px solid #ccc;
        border-radius: 12px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      }

      p.notice {
        margin-top: 20px;
        font-weight: bold;
        color: #cc0000;
      }

      #sorryMessage {
        background: #ffe6e6;
        color: #cc0000;
        text-align: center;
        font-weight: bold;
        font-size: 1.1rem;
      }

      @media (max-width: 600px) {

        form {
          padding: 114px 0px;
          width: 145%;
        }
      }
      #preconfirmControls {
      margin-top: 20px;
      text-align: center;
    }

    .confirm-button {
      display: inline-block;
      margin-right: 10px;
      padding: 12px 0;
      font-size: 1rem;
      text-align: center;
      width: 100%;
      margin-top: 10px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      color: white;
      text-decoration: none;
      transition: background-color 0.3s ease;
    }

    .confirm {
      background-color: #1add1a;
    }

    .confirm:hover {
      background-color: #17b817;
    }

    .not-accept {
      background-color: #ca1313;
    }

    .not-accept:hover {
      background-color: #a01010;
    }

    .user-info {
      display: flex;
      align-items: center;
      gap: 10px;
      position: relative;
    }

    .user-info span {
      color: #333;
    }

    .logout-btn {
      background: none;
      border: none;
      color: #0078D4;
      cursor: pointer;
      font-weight: 600;
      padding: 5px 10px;
      border-radius: 4px;
      display: flex;
      align-items: center;
      gap: 5px;
    }

    .logout-btn:hover {
      background-color: #f0f0f0;
    }

    .user-icon {
      display: none;
      font-size: 1.2rem;
      color: #0078D4;
      cursor: pointer;
      padding: 5px;
      border-radius: 50%;
      transition: background-color 0.3s;
    }

    .user-icon:hover {
      background-color: #f0f0f0;
    }

    /* Calendar Styles */
    .calendar-dropdown {
      position: absolute;
      top: 100%;
      left: 0;
      right: 0;
      background: white;
      border: 1px solid #E0E1DD;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
      z-index: 1000;
      display: none;
      margin-top: 4px;
      padding: 12px;
      min-width: 220px;
      max-width: 240px;
      font-size: 11px;
    }

    .calendar-dropdown.show {
      display: block;
    }

    .calendar-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 12px;
    }

    .calendar-nav {
      background: none;
      border: none;
      cursor: pointer;
      padding: 6px;
      border-radius: 4px;
      color: #1B263B;
      transition: background-color 0.2s;
      font-size: 11px;
    }

    .calendar-nav:hover:not(:disabled) {
      background-color: #f8f9fa;
    }

    .calendar-nav:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .calendar-title {
      font-weight: 600;
      color: #1B263B;
      font-size: 12px;
    }

    .calendar-weekdays {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 3px;
      margin-bottom: 8px;
    }

    .calendar-weekdays div {
      text-align: center;
      font-size: 10px;
      color: #6c757d;
      font-weight: 500;
      padding: 6px 2px;
    }

    .calendar-days {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 3px;
    }

    .calendar-day {
      aspect-ratio: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 4px;
      cursor: pointer;
      font-size: 11px;
      color: #1B263B;
      transition: all 0.2s;
      border: none;
      background: none;
      padding: 3px;
      min-height: 28px;
    }

    .calendar-day:hover:not(.disabled):not(.selected) {
      background-color: #f8f9fa;
    }

    .calendar-day.disabled {
      color: #adb5bd;
      cursor: not-allowed;
    }

    .calendar-day.selected {
      background-color: #1B263B;
      color: white;
    }

    .calendar-day.today {
      border: 2px solid #1B263B;
    }

    .calendar-day.other-month {
      color: #adb5bd;
    }

    /* Responsive calendar styles */
    @media (max-width: 768px) {
      .calendar-dropdown {
        min-width: 200px;
        max-width: 220px;
        padding: 8px;
        margin-top: 2px;
        font-size: 10px;
      }

      .calendar-header {
        margin-bottom: 8px;
      }

      .calendar-nav {
        padding: 4px;
        font-size: 10px;
      }

      .calendar-title {
        font-size: 11px;
      }

      .calendar-weekdays div {
        font-size: 9px;
        padding: 4px 1px;
      }

      .calendar-day {
        font-size: 10px;
        padding: 2px;
        min-height: 24px;
      }
    }

    @media (max-width: 480px) {
      .calendar-dropdown {
        min-width: 180px;
        max-width: 200px;
        padding: 6px;
        left: -10px;
        right: -10px;
        font-size: 9px;
      }

      .calendar-header {
        margin-bottom: 6px;
      }

      .calendar-nav {
        padding: 3px;
        font-size: 9px;
      }

      .calendar-title {
        font-size: 10px;
      }

      .calendar-weekdays div {
        font-size: 8px;
        padding: 3px 1px;
      }

      .calendar-day {
        font-size: 9px;
        padding: 1px;
        min-height: 20px;
      }
    }

    /* Ride selector buttons - Top Right */
    .ride-selector-buttons {
      position: absolute;
      top: 30px;
      right: 30px;
      display: flex;
      gap: 15px;
      z-index: 1000;
    }

    .ride-option {
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 10px 20px;
      border-radius: 50px;
      cursor: pointer;
      transition: all 0.3s ease;
      border: 2px solid #E0E1DD;
      background: white;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }

    .ride-option:hover {
      background-color: #f8f9fa;
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(0,0,0,0.2);
    }

    .ride-option span {
      font-weight: 600;
      color: #495057;
      font-size: 14px;
      text-align: center;
    }

    .ride-option.active {
      background-color: #0D1B2A;
      border-color: #0D1B2A;
      box-shadow: 0 4px 12px rgba(13, 27, 42, 0.3);
    }

    .ride-option.active span {
      color: white;
    }

    /* Responsive design for buttons */
    @media (max-width: 768px) {
      .ride-selector-buttons {
        position: static;
        justify-content: center;
        margin: 20px 0;
        gap: 15px;
      }

      .ride-option {
        padding: 13px 57px;
      }

      .ride-option span {
        font-size: 14px;
      }
    }

    @media (max-width: 480px) {
      .ride-selector-buttons {
        margin: 15px 0;
        gap: 12px;
      }

      .ride-option {
        padding: 13px 57px;
      }

      .ride-option span {
        font-size: 14px;
      }
    }

    .input-group input,
    .input-group select {
      padding: 12px 12px 12px 35px;
      font-size: 16px;
      border-radius: 8px;
      border: 2px solid #E0E1DD;
      min-height: 44px;
      color: #666;
    }

    .input-group input::placeholder {
      color: #666;
      font-size: 16px;
    }

    .input-icon {
      width: 18px;
      height: 18px;
      left: 10px;
    }

    /* Location row specific styles */
    .location-row {
      display: flex;
      gap: 10px;
      align-items: stretch;
    }
    
    .location-row .input-with-icon {
      flex: 1;
      min-width: 0;
    }
    
    .location-row .input-with-icon input {
      width: 100%;
      min-width: 0;
      box-sizing: border-box;
    }

    /* Additional mobile-specific styles for better iPhone compatibility */
    @media (max-width: 480px) {
      .form-overlay {
        max-width: 320px;
        padding: 15px;
        bottom: 15px;
      }
      
      .input-group.location-row {
        gap: 6px !important;
      }
      
      .input-group.location-row .input-with-icon input {
        font-size: 16px !important;
        padding: 10px 10px 10px 30px !important;
        min-height: 40px !important;
        color: #666 !important;
      }
      
      .input-group.location-row .input-icon {
        width: 18px !important;
        height: 18px !important;
        left: 8px !important;
      }
    }

    /* Ensure proper touch targets for iOS */
    @media (max-width: 768px) {
      .input-group input,
      .input-group select,
      button[type="submit"] {
        -webkit-appearance: none;
        -moz-appearance: none;
        appearance: none;
        border-radius: 8px;
        min-height: 44px; /* iOS recommended minimum touch target */
      }
    }
    </style>


</head>
<body>
  <!-- Main 3-column layout -->
  <div class="main-layout">
    <!-- Ride selector buttons - Top Right (Desktop) / Centered (Mobile) -->
    <div class="ride-selector-buttons">
      <div class="ride-option" id="sharedOption" onclick="window.location.href='Shared Ride.html'">
        <span>Shared</span>
      </div>
      <div class="ride-option active" id="personalOption">
        <span>Personal</span>
      </div>
    </div>

    <!-- Benefits section (1 column) -->
    <div class="benefits-section">
      <div class="benefits-container">
        <h3 class="benefits-title">How it works?</h3>
        <ul class="benefits-list">
          <li class="benefit-item" aria-label="Step 1: Tell us your route and find the most affordable match.">
            <div class="benefit-icon">
              <img alt="" src="https://pedrobrandy.github.io/commute/image/Step1CommuteP.png" class="benefit-icon">
            </div>
            <div class="benefit-content">
              <div>
                <p class="benefit-text">Step 1: Tell us your route and find the most affordable match.</p>
              </div>
            </div>
          </li>
          <li class="benefit-item" aria-label="Step 2: Plan ahead — bring along friends, pets, or luggage!">
            <div class="benefit-icon">
              <img alt="" src="https://pedrobrandy.github.io/commute/image/Step2CommuteP.png" class="benefit-icon">
            </div>
            <div class="benefit-content">
              <div>
                <p class="benefit-text">Step 2: Plan ahead — bring along friends, pets, or luggage!</p>
              </div>
            </div>
          </li>
          <li class="benefit-item" aria-label="Step 3: Got a long ride? Choose your favorite music vibe.">
            <div class="benefit-icon">
              <img alt="" src="https://pedrobrandy.github.io/commute/image/Step3Commute.png" class="benefit-icon">
            </div>
            <div class="benefit-content">
              <div>
                <p class="benefit-text">Step 3: Got a long ride? Choose your favorite music vibe.</p>
              </div>
            </div>
          </li>
                   <li class="benefit-item" aria-label="Step 4: Arrive on time, relaxed and ready for the day.">
            <div class="benefit-icon">
              <img alt="" src="https://pedrobrandy.github.io/commute/image/Step4CommuteP.png" class="benefit-icon">
            </div>
            <div class="benefit-content">
              <div>
                <p class="benefit-text">Step 4: Arrive on time, relaxed and ready for the day.</p>
              </div>
            </div>
          </li>
        </ul>
        <a aria-label="" href="https://www.uber.com/ca/en/ride/how-it-works/reserve/#see-prices" target="_self" class="terms-link">See terms</a>
      </div>
    </div>

    <!-- Background image section (2 columns) - RIGHT SIDE -->
    <div class="background-section">
      <div class="form-overlay">
        <form id="travelForm">
          <div class="form-fields">
            <!-- First line: DATE only -->
            <div class="input-group">
              <div class="input-with-icon">
                <img src="https://www.svgrepo.com/show/438428/date-round.svg" alt="Date" class="input-icon">
                <input type="text" id="startDate" placeholder="Date" readonly required />
                <div class="calendar-dropdown" id="calendarDropdown">
                  <div class="calendar-header">
                    <button class="calendar-nav" id="prevMonth" disabled>
                      <svg viewBox="0 0 24 24" width="16" height="16">
                        <path fill-rule="evenodd" clip-rule="evenodd" d="M9 12C9 12.2652 9.10536 12.5196 9.29289 12.7071L13.2929 16.7071C13.6834 17.0976 14.3166 17.0976 14.7071 16.7071C15.0976 16.3166 15.0976 15.6834 14.7071 15.2929L11.4142 12L14.7071 8.70711C15.0976 8.31658 15.0976 7.68342 14.7071 7.29289C14.3166 6.90237 13.6834 6.90237 13.2929 7.29289L9.29289 11.2929C9.10536 11.4804 9 11.7348 9 12Z"></path>
                      </svg>
                    </button>
                    <div class="calendar-title">
                      <span id="currentMonth">June</span>
                      <span id="currentYear">2025</span>
                    </div>
                    <button class="calendar-nav" id="nextMonth">
                      <svg viewBox="0 0 24 24" width="16" height="16">
                        <path fill-rule="evenodd" clip-rule="evenodd" d="M9.29289 7.29289C8.90237 7.68342 8.90237 8.31658 9.29289 8.70711L12.5858 12L9.29289 15.2929C8.90237 15.6834 8.90237 16.3166 9.29289 16.7071C9.68342 17.0976 10.3166 17.0976 10.7071 16.7071L14.7071 12.7071C14.8946 12.5196 15 12.2652 15 12C15 11.7348 14.8946 11.4804 14.7071 11.2929L10.7071 7.29289C10.3166 6.90237 9.68342 6.90237 9.29289 7.29289Z"></path>
                      </svg>
                    </button>
                  </div>
                  <div class="calendar-weekdays">
                    <div>Su</div>
                    <div>Mo</div>
                    <div>Tu</div>
                    <div>We</div>
                    <div>Th</div>
                    <div>Fr</div>
                    <div>Sa</div>
                  </div>
                  <div class="calendar-days" id="calendarDays"></div>
                </div>
              </div>
            </div>

            <!-- Second line: Pickup and Drop-off Location -->
            <div class="input-group location-row">
              <div class="input-with-icon pickup-field">
                <img src="https://www.iconpacks.net/icons/2/free-location-icon-2955-thumb.png" alt="Location" class="input-icon">
                <input type="text" id="pickup" placeholder="Pickup Location" required />
              </div>

              <div class="input-with-icon dropoff-field">
                <img src="https://www.iconpacks.net/icons/2/free-location-icon-2955-thumb.png" alt="Location" class="input-icon">
                <input type="text" id="dropoff" placeholder="Drop-off Location" required />
              </div>
            </div>

            <!-- Third line: ETAY -->
            <div class="input-group">
              <div class="input-with-icon">
                <img src="https://static.vecteezy.com/system/resources/previews/017/259/098/non_2x/clock-icon-time-sign-free-png.png" alt="Time" class="input-icon">
                <input 
                  type="text" 
                  id="ETAY" 
                  name="ETAY"
                  placeholder="What is your ETA? (24h format)" 
                  required 
                  autocomplete="off"
                  pattern="^([0-1]?[0-9]|2[0-3]):[0-5][0-9]$"
                  title="Please enter time in 24-hour format (e.g., 14:30)"
                />
              </div>
            </div>

            <!-- Fourth line: Submit Button -->
            <button type="submit">Submit</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Summary and error messages -->
  <div id="summary" style="display: none;">
    <div id="summaryContent"></div>
    <div id="map"></div>
    <div id="preconfirmControls">
      <button class="confirm-button confirm" onclick="confirmReservation()">Confirm</button>
      <button class="confirm-button not-accept" onclick="notAcceptReservation()">Not Accept</button>
    </div>
  </div>

  <div id="sorryMessage" style="display: none;">
    <p>Sorry, this route is not available for personal rides. Please try a different route or contact us for assistance.</p>
  </div>

  <script src="google-maps-utils.js"></script>
  <script src="auth.js"></script>
  <script src="config.production.js"></script>
  <script>
  let directionsService, directionsRenderer;
  const additionalMinutes = 10;
  let googleMapsUtils;

  async function initMap() {
      console.log('Initializing Google Maps...');
      
      try {
          // Initialize Google Maps utilities
          googleMapsUtils = new GoogleMapsUtils(CONFIG.GOOGLE_MAPS_API_KEY);
          await googleMapsUtils.init();

          // Initialize directions service
          const directions = googleMapsUtils.initDirectionsService();
          if (directions) {
              directionsService = directions.directionsService;
              directionsRenderer = directions.directionsRenderer;
          }

          // Initialize autocomplete for pickup and dropoff
          const pickupInput = document.getElementById("pickup");
          const dropoffInput = document.getElementById("dropoff");

          if (pickupInput) {
              googleMapsUtils.initAutocomplete(pickupInput);
          }

          if (dropoffInput) {
              googleMapsUtils.initAutocomplete(dropoffInput);
          }

          console.log('Google Maps initialized successfully');
      } catch (error) {
          console.error('Error initializing Google Maps:', error);
      }
  }

  function getRouteInfo(origin, destination, travelMode) {
      return new Promise((resolve, reject) => {
      directionsService.route(
          {
          origin,
          destination,
          travelMode,
          },
          (response, status) => {
          if (status === "OK") {
              const leg = response.routes[0].legs[0];
              resolve({
              distanceText: leg.distance.text,
              distanceValue: leg.distance.value,
              durationValue: leg.duration.value,
              durationText: leg.duration.text,
              });
          } else {
              reject("Directions request failed due to " + status);
          }
          }
      );
      });
  }

  function calculatePrice(distanceKm) {
      if (distanceKm >= 100) return 100;
      if (distanceKm >= 80) return 80;
      if (distanceKm >= 35) return 60;
      return 0;
  }

  function convertTimeToHHMMSS(timeStr) {
      // Handle undefined or empty time strings
      if (!timeStr || typeof timeStr !== 'string') {
          console.warn('Invalid time string:', timeStr);
          return "00:00:00";
      }
      
      // Handle 24-hour format (e.g., "14:30")
      const time24Match = timeStr.match(/^([0-1]?[0-9]|2[0-3]):([0-5][0-9])$/);
      if (time24Match) {
          const hours = time24Match[1].padStart(2, '0');
          const minutes = time24Match[2];
          return `${hours}:${minutes}:00`;
      }
      
      // Handle 12-hour format (e.g., "530am", "1pm", "9pm")
      const match = timeStr.match(/(\d{1,2})(\d{2})?(am|pm)/i);
      if (match) {
          let hours = parseInt(match[1]);
          let minutes = match[2] || "00";
          
          // Convert to 24-hour format
          if (match[3].toLowerCase() === 'pm' && hours !== 12) {
              hours += 12;
          } else if (match[3].toLowerCase() === 'am' && hours === 12) {
              hours = 0;
          }
          
          return `${hours.toString().padStart(2, '0')}:${minutes}:00`;
      }
      
      console.warn('Time string format not recognized:', timeStr);
      return "00:00:00";
  }

  document.getElementById("travelForm").addEventListener("submit", async function (e) {
    e.preventDefault();

    const user = JSON.parse(localStorage.getItem('user'));
    if (!user) {
      window.location.href = 'login.html';
      return;
    }

    const origin = document.getElementById("pickup").value;
    const destination = document.getElementById("dropoff").value;

    try {
      const drivingInfo = await getRouteInfo(origin, destination, google.maps.TravelMode.DRIVING);
      const transitInfo = await getRouteInfo(origin, destination, google.maps.TravelMode.TRANSIT);

      const distanceKm = drivingInfo.distanceValue / 1000;
      const price = calculatePrice(distanceKm);

      if (distanceKm < 35) {
        this.style.display = "none";
        document.getElementById("summary").style.display = "none";
        document.getElementById("sorryMessage").style.display = "block";
        return;
      }

      const adjustedDrivingSeconds = drivingInfo.durationValue + additionalMinutes * 60;
      const adjustedHours = Math.floor(adjustedDrivingSeconds / 3600);
      const adjustedMinutes = Math.round((adjustedDrivingSeconds % 3600) / 60);
      const adjustedTimeFormatted = `${adjustedHours > 0 ? adjustedHours + 'hour(s) ' : ''}${adjustedMinutes}min`;

      const ETAY = document.getElementById("ETAY").value;
      const startDate = document.getElementById("startDate").value;

      // Convert ETAY to HH:mm:ss format
      const ETAYFormatted = convertTimeToHHMMSS(ETAY);

      // Prepare reservation data
      const reservationData = {
        type: "Personal Ride",
        name: user.fullName,
        phone: user.phone,
        email: user.email,
        origin: origin,
        destination: destination,
        directionText: "-",
        timeText: "-",
        timeValue: "-",
        startDate: startDate,
        endDate: "-",
        distanceText: drivingInfo.distanceText,
        ETAY: ETAYFormatted,
        price: price,
        adjustedDrivingMinutes: adjustedTimeFormatted,
        adjustedDrivingDuration: adjustedTimeFormatted,
        transitDurationText: transitInfo.durationText,
        estimatedArrivalTime: "-"
      };

      // Send to Google Sheets
      try {
          const formData = new URLSearchParams();
          formData.append("action", "saveReservation");
          formData.append("type", "Personal Ride");
          formData.append("status", "Negociación");
          formData.append("name", user.fullName);
          formData.append("phone", user.phone);
          formData.append("email", user.email);
          formData.append("origin", origin);
          formData.append("destination", destination);
          formData.append("directionText", "-");
          formData.append("timeText", "-");
          formData.append("timeValue", "-");
          formData.append("startDate", startDate);
          formData.append("endDate", "-");
          formData.append("distanceText", drivingInfo.distanceText);
          formData.append("ETAY", ETAYFormatted);
          formData.append("price", price);
          formData.append("adjustedDrivingMinutes", adjustedTimeFormatted);
          formData.append("adjustedDrivingDuration", adjustedTimeFormatted);
          formData.append("transitDurationText", transitInfo.durationText);
          formData.append("estimatedArrivalTime", "-");

          const response = await fetch(CONFIG.GOOGLE_APPS_SCRIPT.MAIN, {
              method: 'POST',
              mode: 'no-cors',
              headers: {
                  'Content-Type': 'application/x-www-form-urlencoded',
              },
              body: formData.toString()
          });

          // Redirect to summary page with data
          const encodedData = encodeURIComponent(JSON.stringify(reservationData));
          window.parent.postMessage({
            type: 'LOAD_SUMMARY',
            data: encodedData
          }, window.location.origin);

      } catch (error) {
          console.error('Error:', error);
          alert('An error occurred while submitting the reservation. Please try again.');
      }

    } catch (error) {
      console.error(error);
    }
  });

  // Initialize map on page load
  document.addEventListener('DOMContentLoaded', function() {
      initMap();
      
      // Calendar functionality
      const dateInput = document.getElementById('startDate');
      const calendarDropdown = document.getElementById('calendarDropdown');
      let currentDate = new Date();
      let selectedDate = null;

      // Initialize calendar
      function initCalendar() {
          updateCalendar();
          
          // Show calendar when clicking on date input
          dateInput.addEventListener('click', function() {
              calendarDropdown.classList.toggle('show');
          });

          // Hide calendar when clicking outside
          document.addEventListener('click', function(e) {
              if (!dateInput.contains(e.target) && !calendarDropdown.contains(e.target)) {
                  calendarDropdown.classList.remove('show');
              }
          });

          // Navigation buttons
          document.getElementById('prevMonth').addEventListener('click', function() {
              currentDate.setMonth(currentDate.getMonth() - 1);
              updateCalendar();
          });

          document.getElementById('nextMonth').addEventListener('click', function() {
              currentDate.setMonth(currentDate.getMonth() + 1);
              updateCalendar();
          });
      }

      function updateCalendar() {
          const monthNames = ['January', 'February', 'March', 'April', 'May', 'June', 
                             'July', 'August', 'September', 'October', 'November', 'December'];
          
          document.getElementById('currentMonth').textContent = monthNames[currentDate.getMonth()];
          document.getElementById('currentYear').textContent = currentDate.getFullYear();

          const firstDay = new Date(currentDate.getFullYear(), currentDate.getMonth(), 1);
          const lastDay = new Date(currentDate.getFullYear(), currentDate.getMonth() + 1, 0);
          const startDate = new Date(firstDay);
          startDate.setDate(startDate.getDate() - firstDay.getDay());

          const calendarDays = document.getElementById('calendarDays');
          calendarDays.innerHTML = '';

          const today = new Date();
          today.setHours(0, 0, 0, 0);

          for (let i = 0; i < 42; i++) {
              const date = new Date(startDate);
              date.setDate(startDate.getDate() + i);

              const dayButton = document.createElement('button');
              dayButton.className = 'calendar-day';
              dayButton.textContent = date.getDate();

              // Check if date is from other month
              if (date.getMonth() !== currentDate.getMonth()) {
                  dayButton.classList.add('other-month');
              }

              // Check if date is today
              if (date.getTime() === today.getTime()) {
                  dayButton.classList.add('today');
              }

              // Check if date is selected
              if (selectedDate && date.getTime() === selectedDate.getTime()) {
                  dayButton.classList.add('selected');
              }

              // Disable past dates
              if (date < today) {
                  dayButton.classList.add('disabled');
              } else {
                  dayButton.addEventListener('click', function() {
                      selectDate(date);
                  });
              }

              calendarDays.appendChild(dayButton);
          }

          // Update navigation buttons
          document.getElementById('prevMonth').disabled = false;
          document.getElementById('nextMonth').disabled = false;
      }

      function selectDate(date) {
          selectedDate = date;
          const monthNames = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 
                             'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
          const formattedDate = `${monthNames[date.getMonth()]} ${date.getDate()}, ${date.getFullYear()}`;
          dateInput.value = formattedDate;
          calendarDropdown.classList.remove('show');
          updateCalendar();
      }

      // Initialize calendar
      initCalendar();
  });

  // Also initialize when window loads (fallback)
  window.addEventListener('load', function() {
      if (!googleMapsUtils) {
          initMap();
      }
  });

  document.getElementById("direction").addEventListener("change", function () {
  const timeSelect = document.getElementById("time");
  const direction = this.value;

  // Limpiar opciones previas
  timeSelect.innerHTML = '<option value="">Select time</option>';

  let times = [];

  if (direction === "kwc-t") {
      times = [
      { value: "530am", label: "5:30 AM" },
      { value: "1pm", label: "1:00 PM" },
      { value: "9pm", label: "9:00 PM" }
      ];
  } else if (direction === "t-kwc") {
      times = [
      { value: "10am", label: "10:00 AM" },
      { value: "4pm", label: "4:00 PM" },
      { value: "11pm", label: "11:00 PM" }
      ];
  }

  times.forEach(t => {
      const option = document.createElement("option");
      option.value = t.value;
      option.textContent = t.label;
      timeSelect.appendChild(option);
  });
  });

  function checkUser() {
      const user = JSON.parse(localStorage.getItem('user'));
      const userInfoElement = document.getElementById('userName');
      const logoutBtn = document.querySelector('.logout-btn');
      const userIcon = document.querySelector('.user-icon');
      
      if (user) {
          userInfoElement.textContent = `Welcome, ${user.fullName}`;
          logoutBtn.innerHTML = '<i class="fas fa-sign-out-alt"></i> Logout';
          logoutBtn.onclick = logout;
          userIcon.className = 'fas fa-user user-icon';
      } else {
          userInfoElement.textContent = '';
          logoutBtn.innerHTML = '<i class="fas fa-sign-in-alt"></i> Login';
          logoutBtn.onclick = checkAuth;
          userIcon.className = 'fas fa-sign-in-alt user-icon';
      }
  }

  function toggleUserMenu() {
      const userInfo = document.querySelector('.user-info');
      userInfo.classList.toggle('mobile-active');
  }

  function checkAuth() {
      window.location.href = 'Login.html';
  }

  window.onload = function() {
      checkUser();
      initMap();
  };

  // Close mobile menu when clicking outside
  document.addEventListener('click', function(event) {
      const userInfo = document.querySelector('.user-info');
      const userIcon = document.querySelector('.user-icon');
      if (!userInfo.contains(event.target)) {
          userInfo.classList.remove('mobile-active');
      }
  });
  </script>
</body>
</html>
